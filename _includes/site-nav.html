<nav class="nav">
  <ul class="list list--nav">
    {% for item in site.pages %}
      {% unless item.title == false or item.title == "" or item.url contains "/page" or item.url contains "/404.html" or item.url contains "/feed." %}
        {% assign children = site.pages | where: "parent", item.title %}
        <li class="item item--nav{% if item.url == page.url %} item--current{% endif %}">
          
          {% if item.collectionpage %}
            {% assign collectiondata = site.collections | where: "label", item.collectionpage | first %}
            <a href="{{ site.baseurl }}{{ item.url }}">{{ collectiondata.title }}</a>
          {% else %}
            <a href="{{ site.baseurl }}{{ item.url }}">{{ item.title }}</a>
          {% endif %}
          
          {% if children and children != empty %}
            <ul class="subnav">
              {% for child in children %}
                <li><a href="{{ site.baseurl }}{{ child.url }}">{{ child.title }}</a></li>
              {% endfor %}
            </ul>
          {% endif %}
        </li>
      {% endunless %}
    {% endfor %}
  </ul>
</nav>
